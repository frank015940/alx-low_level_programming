More functions ad more nested loop tasks
